@using EM.Models
@inject IJSRuntime JsRuntime
@inject IDiciplinaRepositorio DisciplinaRepositorio

<RadzenTemplateForm Data="@Atleta" Submit=@Guardar InvalidSubmit=@EnviarForm>
    <RadzenRow>
        <RadzenNumeric hidden="true" @bind-Value="@Atleta.Id"/>
    </RadzenRow>
    <RadzenRow Gap="2rem" class="rz-p-0 rz-p-lg-4">
        <RadzenColumn Size="12" SizeMD="6">
            <RadzenFieldset Text="Datos Personales">
                <RadzenStack Gap="1rem">
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Nombre" Component="Persona.Nombre"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Nombre" Variant="Variant.Outlined">
                                <RadzenTextBox Name="Nombre" Placeholder="Nombre" @bind-Value="@Atleta.Persona.Nombre"/>
                                <RadzenRequiredValidator Component="Nombre" Property="@Atleta.Persona.Nombre"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Apellidos" Component="Persona.Apellido"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Apellido" Variant="Variant.Outlined">
                                <RadzenTextBox Name="Apellido" Placeholder="Nombre"
                                               @bind-Value="@Atleta.Persona.Apellido"/>
                                <RadzenRequiredValidator Component="Apellido" Property="@Atleta.Persona.Apellido"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Nacionalidad" Component="Persona.NAcionalidad"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Nacionalidad" Variant="Variant.Outlined">
                                <RadzenTextBox Name="Nacionalidad" Placeholder="Nacionalidad"
                                               @bind-Value="@Atleta.Persona.Nacionalidad"/>
                                <RadzenRequiredValidator Component="Nacionalidad" Property="@Atleta.Altura"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Fecha de Nacimiento" Component="Persona.FechaNacimiento"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Fecha de Nacimiento" Variant="Variant.Outlined">
                                <RadzenDatePicker Name="fNAcimiento" Placeholder="Fecha de Nacimiento"
                                                  @bind-Value="@Atleta.Persona.FechaNacimiento"/>
                                <RadzenRequiredValidator Component="fNAcimiento"
                                                         Property="@Atleta.Persona.FechaNacimiento"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenStack>
            </RadzenFieldset>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="6">
            <RadzenFieldset Text="Info. del Atleta">
                <RadzenStack Gap="1rem">
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Altura" Component="Altura"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Altura" Variant="Variant.Outlined">
                                <RadzenNumeric Name="Altura" Placeholder="Altura" @bind-Value="@Atleta.Altura"/>
                                <RadzenRequiredValidator Component="Altura" Property="@Atleta.Altura"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Peso" Component="Peso"/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="8">
                            <RadzenFormField Text="Peso" Variant="Variant.Outlined">
                                <RadzenNumeric Name="Peso" Placeholder="Peso" @bind-Value="@Atleta.Peso"/>
                                <RadzenRequiredValidator Component="Peso" Property="@Atleta.Peso"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow AlignItems="AlignItems.Center">
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenLabel Text="Disciplina" Component=""/>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="4">
                            <RadzenFormField Text="Disciplina" Variant="Variant.Outlined">
                                <RadzenDropDown name="Disciplina" @bind-Value=@Atleta.IdDisciplina Data=@_disciplinas
                                                TextProperty="@nameof(SelectListItem.Value)" ValueProperty="Id"
                                                AllowClear=true Placeholder="Seleccione una Disciplina"
                                                Style="width: 100%; max-width: 400px;"/>
                                <RadzenRequiredValidator Component="Disciplina" Property="@Atleta.IdDisciplina"
                                                         Text="Esto es requerido"/>
                            </RadzenFormField>
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenStack>
            </RadzenFieldset>
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow>
        <RadzenButton Icon="cancel" ButtonType="ButtonType.Button" class="rz-danger" Click="GoBack" Text="Cancelar"/>
        <RadzenButton Icon="save" ButtonType="ButtonType.Submit" class="rz-info" Text="Guardar"/>
    </RadzenRow>
</RadzenTemplateForm>

@code {
    [Parameter] public EventCallback<Atleta> Guardar { get; set; }
    [Parameter] public bool EditMode { get; set; }
    [Parameter] public Atleta Atleta { get; set; } = new (){Persona = new Persona()};
    
    
    List<SelectListItem> _disciplinas = new();

    protected override async Task OnInitializedAsync()
    {
        _disciplinas = await DisciplinaRepositorio.SelectList();
    }

    private async Task GoBack()
    {
        await JsRuntime.InvokeVoidAsync("history.back");
    }

    private async Task EnviarForm()
    {
    }
}